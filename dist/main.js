(()=>{"use strict";const e=e=>{let t=0;return{len:e,hit:function(){return t+=1,1},isSunk:function(){return t===e}}},t=()=>{const t=e(5),n=e(4),r=e(3),o=e(3),c=[e(2),o,r,n,t],i=10,l=Array(i).fill().map((()=>Array(i).fill(0)));let s=4;function a(e,t,n,r){if(n){for(let n=t;n<t+r;n+=1)if(l[e][n])return!1}else for(let n=e;n<e+r;n+=1)if(l[n][t])return!1;return!0}function u(e){return e.map((e=>e.isSunk())).every((e=>!0===e))}return{place:function(e,t,n,r){const o=c[r];if(e>9||t>9)return!1;if(1===n&&t+o.len<11){if(!a(e,t,n,o.len))return!1;for(let n=0;n<i;n+=1)for(let r=0;r<i;r+=1)n===e&&r<t+o.len&&r>=t&&(l[n][r]=o);return s-=1,o.len}if(0===n&&e+o.len<11){if(!a(e,t,n,o.len))return!1;for(let n=0;n<i;n+=1)for(let r=0;r<i;r+=1)n>=e&&n<e+o.len&&r===t&&(l[n][r]=o);return s-=1,o.len}return!1},recieveAttack:function(e,t){return 1===l[e][t]?null:l[e][t]?(l[e][t]=l[e][t].hit(),u(c)?[e,t,1,0]:[e,t,1]):(l[e][t]=1,[e,t,0])},haveAllSunk:u,shipToHover:function(){return-1!==s&&c[s].len}}},n=()=>{const e=t();let n=5;return{gb:e,attackTile:function(e,t,n){return n.recieveAttack(e,t)},placeShip:function(t,r,o){if(!n)return!1;const c=e.place(t,r,o,n-1);return c&&(n-=1),c}}},r=()=>{const e=t();function n(t){let r;const o=Math.floor(10*Math.random()),c=Math.floor(10*Math.random());r=Math.random()<.5?0:1,e.place(o,c,r,t)||n(t)}return{gb:e,initaializeAIGb:function(){n(0),n(1),n(2),n(3),n(4)},attackTile:function e(t){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),o=t.recieveAttack(n,r);return null==o?e(t):o}}},o=function(){const e=document.querySelector("#playerGb"),t=document.querySelector("#aiGb");for(;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)t.removeChild(t.firstChild);for(let t=0;t<10;t++)for(let n=0;n<10;n++){const r=document.createElement("div");r.classList.add("ptile"),r.classList.add(`p${t}x`),r.classList.add(`p${n}y`),e.append(r)}for(let e=0;e<10;e++)for(let n=0;n<10;n++){const r=document.createElement("div");r.classList.add("aitile"),r.classList.add(`a${e}x`),r.classList.add(`a${n}y`),t.append(r)}},c=function(){document.querySelectorAll(".ptile").forEach((e=>e.classList.remove("greenHover")))},i=(()=>{const e=document.querySelector("#axisBtn");return{getCoords:e=>{let t,n;return 3===e.target.classList.length&&(t=e.target.classList[1].charAt(1),n=e.target.classList[2].charAt(1),[Number(t),Number(n)])},determineAxis:()=>"X"===e.textContent?1:0,changeAxisBtn:e=>{"X"===e.target.textContent?e.target.textContent="Y":e.target.textContent="X"}}})(),l=i,s=(e,t)=>{const n=document.querySelector(`.${t}${e[0]}x.${t}${e[1]}y`);e[2]?n.classList.add("green"):n.classList.add("red")},a=function(e){const t=document.querySelector("#instructions");"p"===e?(t.textContent="You Win!!",t.classList.add("green")):(t.textContent="Game Over: You Lose!!",t.classList.add("red"));const n=document.createElement("div");n.textContent="Restart Game!",n.id="resetBtn",document.querySelector("#resetBtnCont").append(n)},u=function(e){const t=document.querySelector("#instructions");t.className="",1===e?t.textContent="Attack Opponent":2===e&&(t.textContent="Place your ships")},d=(()=>{function e(e,t,n,r){if(n)for(let n=t;n<t+r;n++){const t=document.querySelector(`.p${e}x.p${n}y`);if(t.classList.contains("select")||t.classList.contains("greenHover"))return!1}else for(let n=e;n<e+r;n++){const e=document.querySelector(`.p${n}x.p${t}y`);if(e.classList.contains("select")||e.classList.contains("greenHover"))return!1}return!0}return{hover:function(t,n,r,o){if(!(t>9||n>9)){if(1===r&&n+o<11){if(!e(t,n,r,o))return;for(let e=0;e<10;e++)for(let r=0;r<10;r++)e===t&&r<n+o&&r>=n&&document.querySelector(`.p${e}x.p${r}y`).classList.add("greenHover")}if(0===r&&t+o<11){if(!e(t,n,r,o))return;for(let e=0;e<10;e++)for(let r=0;r<10;r++)e>=t&&e<t+o&&r===n&&document.querySelector(`.p${e}x.p${r}y`).classList.add("greenHover")}}}}})();let f=n(),m=r();function p(e){c();const t=l.getCoords(e),n=l.determineAxis(),r=f.placeShip(t[0],t[1],n);((e,t,n,r)=>{if(n)for(let n=t;n<t+r;n++)document.querySelector(`.ptile.p${e}x.p${n}y`).classList.add("select");else for(let n=e;n<e+r;n++)document.querySelector(`.ptile.p${n}x.p${t}y`).classList.add("select")})(t[0],t[1],n,r),2===r&&(u(1),g.forEach((e=>e.addEventListener("click",h))))}function h(e){const t=l.getCoords(e);if(!t)return;let n=f.attackTile(t[0],t[1],m.gb);s(n,"a"),4!==n.length?(n=m.attackTile(f.gb),s(n,"p"),4===n.length&&(a("a"),document.querySelector("#resetBtn").addEventListener("click",S))):(a("p"),document.querySelector("#resetBtn").addEventListener("click",S))}function v(e){const t=f.gb.shipToHover();t||(y.forEach((e=>e.removeEventListener("mouseover",v))),y.forEach((e=>e.removeEventListener("mouseleave",v))));const n=l.getCoords(e),r=l.determineAxis();c(),d.hover(n[0],n[1],r,t)}o(),m.initaializeAIGb();let y=document.querySelectorAll(".ptile");y.forEach((e=>e.addEventListener("click",p))),y.forEach((e=>e.addEventListener("mouseover",v))),y.forEach((e=>e.addEventListener("mouseleave",v)));let L=document.querySelector("#axisBtn");L.addEventListener("click",l.changeAxisBtn);let g=document.querySelectorAll(".aitile");function S(){o(),f=n(),m=r(),m.initaializeAIGb(),y=document.querySelectorAll(".ptile"),y.forEach((e=>e.addEventListener("click",p))),y.forEach((e=>e.addEventListener("mouseover",v))),y.forEach((e=>e.addEventListener("mouseleave",v))),L=document.querySelector("#axisBtn"),L.addEventListener("click",l.changeAxisBtn),g=document.querySelectorAll(".aitile"),document.querySelector("#resetBtn").remove(),u(2)}})();