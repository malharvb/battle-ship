(()=>{"use strict";const e=e=>{let t=0;return{len:e,hit:function(){return t+=1,1},isSunk:function(){return t===e}}},t=()=>{const t=e(5),n=e(4),r=e(3),c=e(3),l=[e(2),c,r,n,t],i=10,o=Array(i).fill().map((()=>Array(i).fill(0)));function a(e,t,n,r){if(n){for(let n=t;n<t+r;n++)if(o[e][n])return!1}else for(let n=e;n<e+r;n++)if(o[n][t])return!1;return!0}function s(e){return e.map((e=>e.isSunk())).every((e=>!0===e))}return{place:function(e,t,n,r){const c=l[r];if(e>9||t>9)return!1;if(1===n&&t+c.len<11){if(!a(e,t,n,c.len))return!1;for(let n=0;n<i;n++)for(let r=0;r<i;r++)n===e&&r<t+c.len&&r>=t&&(o[n][r]=c);return c.len}if(0===n&&e+c.len<11){if(!a(e,t,n,c.len))return!1;for(let n=0;n<i;n++)for(let r=0;r<i;r++)n>=e&&n<e+c.len&&r===t&&(o[n][r]=c);return c.len}return!1},recieveAttack:function(e,t){return console.log(o),1===o[e][t]?null:o[e][t]?(o[e][t]=o[e][t].hit(),s(l)?[e,t,1,0]:[e,t,1]):(o[e][t]=1,[e,t,0])},haveAllSunk:s}},n=()=>{const e=t();let n=5;return{gb:e,attackTile:function(e,t,n){return n.recieveAttack(e,t)},placeShip:function(t,r,c){if(!n)return!1;const l=e.place(t,r,c,n-1);return l&&(n-=1),l}}},r=()=>{const e=t();return{gb:e,initaializeAIGb:function(){e.place(0,0,0,2),e.place(2,2,1,0),e.place(9,7,1,1),e.place(4,5,1,3),e.place(5,2,0,4)},attackTile:function e(t){const n=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),c=t.recieveAttack(n,r);return null==c?e(t):c}}},c=function(){const e=document.querySelector("#playerGb"),t=document.querySelector("#aiGb");for(;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)t.removeChild(t.firstChild);for(let t=0;t<10;t++)for(let n=0;n<10;n++){const r=document.createElement("div");r.classList.add("ptile"),r.classList.add(`p${t}x`),r.classList.add(`p${n}y`),e.append(r)}for(let e=0;e<10;e++)for(let n=0;n<10;n++){const r=document.createElement("div");r.classList.add("aitile"),r.classList.add(`a${e}x`),r.classList.add(`a${n}y`),t.append(r)}},l=(()=>{const e=document.querySelector("#axisBtn");return{getCoords:e=>{let t,n;return 3===e.target.classList.length&&(t=e.target.classList[1].charAt(1),n=e.target.classList[2].charAt(1),[Number(t),Number(n)])},determineAxis:()=>"X"===e.textContent?1:0,changeAxisBtn:e=>{"X"===e.target.textContent?e.target.textContent="Y":e.target.textContent="X"}}})(),i=l,o=(e,t)=>{const n=document.querySelector(`.${t}${e[0]}x.${t}${e[1]}y`);e[2]?n.classList.add("green"):n.classList.add("red")},a={gameOverTextDisp:function(e){const t=document.querySelector("#instructions");"p"===e?(t.textContent="You Win!!",t.classList.add("green")):(t.textContent="Game Over: You Lose!!",t.classList.add("red"));const n=document.createElement("div");n.textContent="Restart Game!",n.id="resetBtn",document.querySelector("#resetBtnCont").append(n)}},s=a,u=function(e){const t=document.querySelector("#instructions");t.className="",1===e?t.textContent="Attack Opponent":2===e&&(t.textContent="Place your ships")};let d,f=n(),m=r();c(),m.initaializeAIGb();let p=5;function h(){c(),f=n(),m=r(),m.initaializeAIGb(),x=document.querySelectorAll(".ptile"),x.forEach((e=>e.addEventListener("click",y))),v=document.querySelector("#axisBtn"),v.addEventListener("click",i.changeAxisBtn),L=document.querySelectorAll(".aitile"),L.forEach((e=>e.addEventListener("click",g))),d.remove(),u(2)}function y(e){const t=i.getCoords(e),n=i.determineAxis();p=f.placeShip(t[0],t[1],n),p&&((e,t,n,r)=>{if(n)for(let n=t;n<t+r;n++)document.querySelector(`.ptile.p${e}x.p${n}y`).classList.add("select");else for(let n=e;n<e+r;n++)document.querySelector(`.ptile.p${n}x.p${t}y`).classList.add("select")})(t[0],t[1],n,p),2===p&&u(1)}function g(e){if(2!==p&&p)return;const t=i.getCoords(e);if(!t)return;let n=f.attackTile(t[0],t[1],m.gb);if(o(n,"a"),4===n.length)return s.gameOverTextDisp("p"),d=document.querySelector("#resetBtn"),void d.addEventListener("click",h);n=m.attackTile(f.gb),o(n,"p"),4===n.length&&(s.gameOverTextDisp("a"),d=document.querySelector("#resetBtn"),d.addEventListener("click",h))}let x=document.querySelectorAll(".ptile");x.forEach((e=>e.addEventListener("click",y)));let v=document.querySelector("#axisBtn");v.addEventListener("click",i.changeAxisBtn);let L=document.querySelectorAll(".aitile");L.forEach((e=>e.addEventListener("click",g)))})();